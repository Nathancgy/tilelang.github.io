Search.setIndex({"docnames": ["deeplearning_operators/convolution", "deeplearning_operators/elementwise", "deeplearning_operators/flash_attention", "deeplearning_operators/flash_linear_attention", "deeplearning_operators/gemv", "deeplearning_operators/matmul", "deeplearning_operators/matmul_dequant", "deeplearning_operators/tmac_gpu", "get_started/Installation", "get_started/overview", "index", "language_ref/ast", "language_ref/primitives", "language_ref/tilelibrary", "privacy", "tutorials/annotate_memory_layout", "tutorials/auto_tuning", "tutorials/debug_tools_for_tilelang", "tutorials/jit_compilation", "tutorials/pipelining_computations_and_data_movements", "tutorials/writing_kernels_with_thread_primitives", "tutorials/writing_kernels_with_tilelibrary"], "filenames": ["deeplearning_operators/convolution.md", "deeplearning_operators/elementwise.md", "deeplearning_operators/flash_attention.md", "deeplearning_operators/flash_linear_attention.md", "deeplearning_operators/gemv.md", "deeplearning_operators/matmul.md", "deeplearning_operators/matmul_dequant.md", "deeplearning_operators/tmac_gpu.md", "get_started/Installation.md", "get_started/overview.md", "index.md", "language_ref/ast.md", "language_ref/primitives.md", "language_ref/tilelibrary.md", "privacy.md", "tutorials/annotate_memory_layout.md", "tutorials/auto_tuning.md", "tutorials/debug_tools_for_tilelang.md", "tutorials/jit_compilation.md", "tutorials/pipelining_computations_and_data_movements.md", "tutorials/writing_kernels_with_thread_primitives.md", "tutorials/writing_kernels_with_tilelibrary.md"], "titles": ["Convolution", "ElementWise Operators", "Flash Attention", "Flash Linear Attention", "General Matrix-Vector Multiplication (GEMV)", "General Matrix-Matrix Multiplication with Tile Library", "General Matrix-Matrix Multiplication with Dequantization", "TMAC: Look Up Table Based Mixed Precision Computing", "Installation Guide", "The Tile Language: A Brief Introduction", "\ud83d\udc4b Welcome to Tile Language", "Tile Language AST", "Tile Language: Primitives", "Tile Language: TileLibrary", "Privacy", "Annotate Memory Layout", "Auto-Tuning Techniques for Performance Optimization", "Debugging Tile Language Programs", "Just In Time Compilation", "Pipelining Computation and Data Movement", "Writing High-Performance Kernels with Thread Primitives", "Writing High-Performance Kernels with the Tile Library"], "terms": {"author": [1, 5, 16, 17], "chenghua": 1, "wang": [1, 5, 17], "thi": [1, 5, 8, 9, 13, 17], "document": [1, 5, 17], "i": [1, 5, 8, 9, 10, 13, 14, 16, 17], "still": [1, 5], "experiment": [1, 5], "mai": [1, 5, 8, 9, 17], "incomplet": [1, 5], "suggest": [1, 5], "improv": [1, 5, 8, 9], "ar": [1, 5, 9, 17], "highli": [1, 5, 9], "encourag": [1, 5], "pleas": [1, 5, 8], "submit": [1, 5], "pr": [1, 5], "wide": 1, "us": [1, 5, 9, 13, 17], "deep": 1, "learn": 1, "often": [1, 17], "serv": 1, "first": [1, 9, 17], "exampl": [1, 9, 13], "encount": [1, 17], "those": [1, 17], "begin": 1, "explor": [1, 5, 16], "parallel": [1, 5, 9, 10, 16, 17], "program": [1, 5, 10, 16], "tutori": [1, 5, 17], "analyz": [1, 17], "sever": [1, 17], "implement": [1, 9, 13, 17], "addit": [1, 9, 16], "compar": [1, 5], "them": [1, 17], "correspond": [1, 9], "By": [1, 5, 9, 10, 17], "end": 1, "you": [1, 5, 8, 13, 16, 17], "an": [1, 5, 9, 10, 17], "The": [1, 5, 8, 10, 13, 16, 17], "similar": [1, 5], "differ": [1, 9, 16], "between": [1, 9, 13], "note": [1, 8, 9, 13], "doe": [1, 5], "delv": 1, "deepli": 1, "design": [1, 5, 9, 10], "principl": 1, "For": [1, 5, 8, 9, 17], "broader": 1, "understand": [1, 9], "we": [1, 5, 8, 9, 13, 17], "recommend": [1, 8, 16], "consult": 1, "overview": [1, 5, 9], "def": [1, 5, 16, 17], "elementwise_add": 1, "n": [1, 5, 16, 17], "thread": [1, 5, 9, 10, 13, 17], "256": [1, 16], "dtype": [1, 5, 13, 16, 17], "bfloat16": 1, "t": [1, 5, 8, 9, 10, 16], "prim_func": [1, 5, 16, 17], "main": [1, 5, 16, 17], "A": [1, 5, 10, 13, 16, 17], "buffer": [1, 5, 9, 13, 16, 17], "b": [1, 5, 9, 13, 16], "c": [1, 5, 8, 9, 13, 16, 17], "kernel": [1, 5, 9, 10, 16, 17], "ceildiv": [1, 5], "b_x": 1, "vector": [1, 10, 13, 17], "return": [1, 5, 13, 16, 17], "all": [1, 8, 13, 14], "logic": [1, 5, 9, 17], "must": [1, 13], "within": [1, 9, 13, 17], "scope": [1, 13], "In": [1, 5, 9, 10, 17], "initi": [1, 5, 9], "requir": [1, 5, 8, 17], "specifi": [1, 5, 8], "both": [1, 5], "grid": [1, 5, 13], "size": [1, 5, 13], "number": [1, 9, 13], "per": 1, "block": [1, 5, 9, 16], "valu": [1, 17], "bx": [1, 5, 9], "blockidx": [1, 13, 17], "x": [1, 5, 13], "provid": [1, 5, 9, 16, 17], "process": [1, 8, 9], "data": [1, 5, 9, 10, 13, 14, 17], "tile": [1, 8, 16], "1": [1, 5, 9, 17], "assign": [1, 5, 9], "comput": [1, 5, 9, 10, 17], "familiar": 1, "might": [1, 9, 17], "wonder": 1, "where": [1, 5, 17], "threadidx": [1, 17], "fit": 1, "code": [1, 5, 8, 9, 16, 17], "insid": [1, 9, 13, 17], "level": [1, 5, 9, 10, 17], "your": [1, 5], "focu": [1, 9, 10], "sole": 1, "defin": [1, 5, 9, 16, 17], "dure": [1, 9, 17], "automat": [1, 5, 9], "map": [1, 5, 9, 13, 16], "appli": 1, "further": [1, 9, 17], "optim": [1, 5, 9, 10, 13, 17], "gener": [1, 8, 9, 10], "close": 1, "align": 1, "carefulli": [1, 17], "handcraft": 1, "demonstr": [1, 5, 9, 16, 17], "section": [1, 9], "2": [1, 5, 9, 13, 17], "concret": 1, "while": [1, 5, 16], "also": [1, 5, 9, 16], "support": [1, 5, 9, 13], "semant": 1, "cover": [1, 17], "subsequ": [1, 9], "discuss": [1, 9], "can": [1, 5, 8, 9, 13, 16, 17], "follow": [1, 8, 9, 16], "1024": [1, 5, 17], "out_idx": [1, 5, 16], "target": [1, 5, 9, 16, 17], "execution_backend": 1, "cython": 1, "launch": [1, 13], "straightforward": 1, "just": [1, 5, 10], "call": [1, 5, 9, 17], "directli": [1, 8, 9, 16, 17], "like": [1, 5, 9, 17], "function": [1, 5, 13, 17], "extend": [1, 9], "two": [1, 17], "dimension": 1, "case": [1, 13, 17], "effici": [1, 5, 9, 16], "practic": 1, "below": [1, 5, 9, 17], "from": [1, 5, 9, 10, 13, 17], "test": [1, 5, 8], "reader": 1, "refer": [1, 5, 9, 17], "import": [1, 5, 8, 16, 17], "languag": [1, 5, 16], "m": [1, 5, 16, 17], "block_m": [1, 5, 9, 16, 17], "block_n": [1, 5, 9, 16, 17], "in_dtyp": [1, 16], "out_dtyp": [1, 16], "start_x": 1, "start_i": 1, "local_i": 1, "local_x": 1, "y": [1, 8, 13], "abov": 1, "fix": 1, "wa": [1, 17], "howev": [1, 5], "usag": [1, 5, 9], "want": [1, 5, 8], "so": [1, 8], "handl": [1, 5], "replac": 1, "symbol": 1, "make": [1, 8, 9], "dimens": [1, 5, 13, 17], "illustr": [1, 9, 17], "result": [1, 5, 16, 17], "includ": [1, 5, 8, 9, 17], "int": 1, "paramet": 1, "after": [1, 5, 8, 9, 13, 17], "bfloat16_t": 1, "__restrict__": 1, "incorpor": [1, 9], "check": [1, 17], "condit": [1, 17], "come": 1, "cost": 1, "These": [1, 5, 9], "prevent": 1, "perform": [1, 9, 10, 13, 17], "more": [1, 5, 9, 17], "advanc": [1, 5, 17], "introduc": [1, 5, 17], "next": 1, "involv": [1, 16], "associ": 1, "review": 1, "befor": [1, 8, 17], "paragraph": 1, "clearer": 1, "when": [1, 5, 9, 13, 17], "let": [1, 5, 9], "": [1, 5, 9, 13, 17], "set": [1, 5, 8, 16], "2047": 1, "num_per_thread": 1, "8": [1, 8, 17], "j": [1, 5, 8], "offset": 1, "extern": 1, "__global__": 1, "void": 1, "__launch_bounds__": 1, "main_kernel": 1, "pragma": 1, "unrol": 1, "0": [1, 5, 8, 13, 16, 17], "observ": 1, "did": 1, "coalesc": [1, 9], "memori": [1, 5, 10, 13, 17], "access": [1, 8, 9], "fact": 1, "except": 1, "tail": 1, "group": 1, "other": [1, 9, 13, 16, 17], "could": 1, "have": [1, 8, 9], "execut": [1, 9, 17], "simplic": 1, "breviti": 1, "typic": 1, "new": [1, 8], "write": [1, 5, 9, 10, 13, 17], "style": 1, "float": [1, 5, 16, 17], "idx": 1, "blockdim": 1, "each": [1, 5, 9, 13], "singl": [1, 5, 13], "element": [1, 13], "which": [1, 5, 8, 9, 16, 17], "evid": 1, "ineffici": 1, "sinc": [1, 5, 13], "common": [1, 16], "acceler": [1, 9, 16], "techniqu": [1, 10], "util": [1, 9], "written": [1, 5], "e": [1, 5, 8, 9, 10, 13, 16, 17], "g": [1, 5, 8, 9, 10, 13, 16, 17], "loop": [1, 5, 9, 13, 16], "base": [1, 5, 8, 10, 17], "travers": [1, 16], "beginn": [1, 9], "addition": [1, 9], "final": [1, 9, 17], "remain": 1, "transpar": 1, "retriev": 1, "get_kernel_sourc": [1, 5, 17], "method": 1, "produc": [1, 13, 17], "32": [1, 5, 13, 16, 17], "uint4": 1, "__1": 1, "v_": 1, "v__1": 1, "nv_bfloat162": 1, "z": 1, "w": 1, "onli": [1, 13], "variou": [1, 5, 9], "aforement": 1, "its": 1, "behavior": [1, 5, 9, 17], "sometim": [1, 17], "appear": 1, "counterintuit": [1, 9], "task": 1, "effect": 1, "activ": 1, "interestingli": 1, "configur": [1, 5, 8], "retain": [1, 5], "origin": [1, 9], "alloc": [1, 5, 13], "scenario": 1, "explicitli": [1, 5, 9], "help": [1, 9, 16, 17], "guid": [1, 10], "lead": 1, "intend": [1, 9, 17], "present": 1, "aha": 1, "convent": 1, "intuit": 1, "But": 1, "what": 1, "happen": 1, "hint": [1, 5, 16], "instanc": [1, 17], "regist": [1, 5, 9, 13, 17], "copi": [1, 5, 8, 9, 10, 17], "unlik": 1, "previou": 1, "load": [1, 5, 9, 13], "num_ele_per_thread": 1, "a_regist": 1, "alloc_frag": [1, 5, 9, 10], "b_regist": 1, "c_regist": 1, "s_start": 1, "s_end": 1, "ldg": 1, "128": [1, 5, 16, 17], "tid": 1, "stg": 1, "respons": 1, "movement": [1, 9, 10], "individu": 1, "reson": 1, "develop": [1, 8, 9, 10], "u": 1, "now": 1, "8192": 1, "2048": 1, "emerg": [1, 5], "actual": 1, "simpli": 1, "reassign": 1, "respect": [1, 17], "To": [1, 8], "evalu": 1, "complex": [1, 5], "one": [1, 13, 17], "same": [1, 9], "version": [1, 10, 17], "templat": [1, 16], "nv_bfloat16": 1, "const": [1, 17], "namespac": 1, "tensor": [1, 5], "t_c": 1, "make_tensor": 1, "make_gmem_ptr": 1, "make_shap": 1, "t_a": 1, "t_b": 1, "t_c_tile": 1, "local_til": 1, "make_coord": 1, "t_a_til": 1, "t_b_tile": 1, "reg_buffer_a": 1, "make_tensor_lik": 1, "reg_buffer_b": 1, "reg_buffer_c": 1, "auto": [1, 5, 10, 17], "reg_c_vector": 1, "recast": 1, "reg_a_vector": 1, "reg_b_vector": 1, "vec_idx": 1, "reg_c_flat": 1, "showcas": [1, 9], "approach": [1, 5, 9, 17], "significantli": [1, 9, 17], "reduc": [1, 9, 13], "enabl": [1, 5, 8, 9], "high": [1, 5, 9, 10], "minim": [1, 9], "nevertheless": 1, "work": [1, 9], "demand": [1, 5, 9], "care": 1, "attent": [1, 5, 10], "specif": [1, 5, 8, 9, 10, 17], "detail": [1, 5, 9], "ensur": [1, 8], "essenti": [1, 8, 17], "thoroughli": 1, "examin": [1, 5, 17], "draw": 1, "inspir": 1, "blog": 1, "http": [1, 8], "zhuanlan": 1, "zhihu": 1, "com": [1, 8], "p": 1, "690703999": 1, "lei": [5, 17], "tilelang": [5, 8, 9, 17], "domain": [5, 10], "It": [5, 13, 16], "three": [5, 8, 9, 16, 17], "abstract": [5, 9], "user": [5, 8, 9, 14, 16, 17], "pure": [5, 9], "without": [5, 9, 10], "knowledg": 5, "concern": 5, "hardwar": [5, 17], "cach": [5, 9, 13], "etc": [5, 17], "compil": [5, 10, 13, 17], "runtim": [5, 8, 9], "schedul": [5, 16], "conceptu": 5, "idea": 5, "behind": 5, "tvm": [5, 10, 17], "awar": [5, 9], "architectur": [5, 9], "share": [5, 9, 13], "necessarili": [5, 17], "drop": 5, "down": 5, "lowest": 5, "explicit": 5, "control": [5, 9], "mode": [5, 8], "somewhat": 5, "triton": 5, "model": [5, 10], "oper": [5, 8, 9, 13, 16, 17], "do": [5, 17], "layout": [5, 9, 10], "infer": [5, 9, 13], "pipelin": [5, 9, 10], "3": [5, 13], "take": [5, 8, 17], "full": 5, "primit": [5, 9, 10, 17], "almost": 5, "hand": [5, 9], "cuda": [5, 8, 9, 16, 17], "hip": [5, 9], "expert": [5, 9], "who": [5, 8, 9], "need": [5, 8, 9, 13, 17], "manag": [5, 9], "everi": 5, "ptx": 5, "inlin": 5, "assembli": 5, "figur": [5, 9], "flow": [5, 10], "walk": 5, "through": [5, 16, 17], "how": [5, 9, 17], "up": [5, 10], "invok": 5, "gemm": [5, 9, 10, 16, 17], "intrins": [5, 9], "show": [5, 17], "run": [5, 8, 9, 16, 17], "python": [5, 8, 9, 10, 17], "measur": 5, "balanc": 5, "express": 5, "enough": 5, "flexibl": [5, 9], "finer": 5, "divers": 5, "backend": [5, 8, 9, 16], "nvidia": [5, 8, 9, 17], "amd": [5, 9], "cpu": [5, 10, 16, 17], "simplifi": [5, 8, 16, 17], "built": [5, 8, 16, 17], "yet": [5, 8, 9], "option": [5, 8], "tune": [5, 9, 10, 17], "veri": 5, "comfort": 5, "incur": 5, "longer": 5, "time": [5, 8, 10], "some": [5, 8, 13, 17], "fusion": 5, "pattern": [5, 9, 17], "flash": [5, 10], "easili": 5, "give": 5, "effort": 5, "raw": 5, "thu": 5, "strike": 5, "portabl": 5, "reason": [5, 9], "concis": [5, 9, 10], "snippet": [5, 9, 17], "alloc_shar": [5, 9, 10], "fragment": [5, 9, 13, 17], "accumul": [5, 9], "softwar": 5, "across": 5, "k": [5, 16, 17], "appropri": 5, "mma": 5, "instruct": [5, 8], "make_mma_swizzle_layout": 5, "matmul": [5, 9, 16, 17], "block_k": [5, 9, 16, 17], "float16": [5, 16, 17], "accum_dtyp": [5, 16, 17], "context": [5, 9], "a_shar": 5, "b_share": 5, "c_local": 5, "comment": 5, "out": [5, 13], "default": 5, "annotate_layout": 5, "swizzl": 5, "raster": 5, "use_swizzl": [5, 10], "panel_s": 5, "10": [5, 8, 16], "true": [5, 16], "clear": [5, 9, 10], "local": [5, 9], "ko": 5, "num_stag": [5, 13, 16], "global": [5, 9, 13], "creat": [5, 8], "func": [5, 17], "jit": [5, 16], "jit_kernel": 5, "torch": [5, 17], "prepar": 5, "input": [5, 9], "pytorch": [5, 8], "randn": 5, "devic": [5, 9, 14], "4": [5, 8, 16, 17], "ref_c": 5, "5": [5, 16], "valid": [5, 17], "correct": 5, "assert_clos": 5, "rtol": 5, "1e": 5, "atol": 5, "print": [5, 8], "output": [5, 8, 17], "match": 5, "6": 5, "inspect": [5, 17], "cuda_sourc": 5, "7": [5, 8], "profil": [5, 17], "get_profil": 5, "latenc": [5, 9], "do_bench": 5, "f": [5, 8, 17], "entir": [5, 9, 17], "space": [5, 9], "though": 5, "slice": 5, "arrang": 5, "asynchron": 5, "overlap": 5, "arithmet": 5, "argument": 5, "indic": [5, 17], "depth": [5, 9], "mark": 5, "avail": [5, 8], "under": 5, "hood": 5, "cutlass": 5, "cute": 5, "wmma": 5, "On": 5, "separ": 5, "compos": [5, 9], "back": 5, "mani": 5, "low": [5, 9, 10], "allow": [5, 9, 10, 17], "annot": [5, 10], "pass": [5, 9, 17], "manual": [5, 9, 16], "mix": [5, 9, 10], "part": 5, "fine": [5, 9], "grain": [5, 9], "keep": [5, 9], "rest": 5, "tuner": 5, "achiev": 5, "better": 5, "than": [5, 8, 9, 17], "vendor": [5, 17], "intern": 5, "benchmark": 5, "fp16": [5, 13], "multipli": 5, "4090": 5, "a100": 5, "h100": 5, "mi300x": 5, "ha": [5, 13, 16], "shown": 5, "1x": 5, "speedup": 5, "over": 5, "cubla": 5, "rtx": 5, "97x": 5, "par": 5, "0x": 5, "04x": 5, "rang": 5, "08x": 5, "25x": 5, "depend": [5, 8, 9], "vari": 5, "stage": [5, 17], "capabl": 5, "With": [5, 9], "few": 5, "line": [5, 17], "along": 5, "dispatch": 5, "verifi": [5, 8], "against": 5, "abil": [5, 9], "friendli": [5, 9], "tunabl": 5, "experi": 5, "see": [5, 16, 17], "scale": 5, "partial": [5, 9], "lower": [5, 9, 17], "meanwhil": 5, "consid": [5, 13, 17], "github": [5, 8, 10], "bitbla": 5, "pycuda": 5, "prerequisit": 8, "via": [8, 9], "wheel": 8, "pypi": 8, "system": [8, 9], "ubuntu": 8, "20": [8, 16], "04": 8, "later": [8, 13], "11": 8, "easiest": 8, "wai": [8, 13], "lang": [8, 10], "latest": 8, "command": 8, "termin": 8, "altern": 8, "choos": [8, 9], "prebuilt": 8, "packag": 8, "releas": 8, "page": 8, "dev0": 8, "cu120": 8, "py3": 8, "none": [8, 16], "ani": 8, "whl": 8, "repositori": 8, "git": 8, "ai": 8, "__version__": 8, "linux": 8, "docker": 8, "contain": [8, 9, 16], "necessari": [8, 9, 10], "gpu": [8, 9, 10, 16, 17], "rm": 8, "ipc": 8, "host": 8, "nvcr": 8, "io": 8, "23": 8, "01": 8, "step": 8, "certain": 8, "pre": [8, 16], "requisit": 8, "apach": 8, "debian": 8, "sudo": 8, "apt": 8, "get": [8, 17], "updat": [8, 13], "python3": 8, "dev": 8, "setuptool": 8, "gcc": 8, "libtinfo": 8, "zlib1g": 8, "cmake": 8, "libedit": 8, "libxml2": 8, "clone": 8, "recurs": 8, "cd": 8, "patient": 8, "If": [8, 13], "current": [8, 13], "alreadi": 8, "compat": 8, "flag": 8, "directori": 8, "exist": [8, 16, 17], "path": 8, "mkdir": 8, "dtvm_prebuild_path": 8, "workspac": 8, "16": [8, 17], "environ": 8, "variabl": [8, 13, 17], "pythonpath": 8, "modul": 8, "export": 8, "tvm_import_python_path": 8, "3rd": 8, "parti": 8, "framework": [8, 16], "prefer": 8, "fetch": 8, "file": [8, 9, 17], "desir": [8, 9, 17], "llvm": [8, 9, 17], "cp": 8, "3rdparti": 8, "config": [8, 16], "echo": 8, "use_llvm": 8, "ON": 8, "use_cuda": 8, "use_rocm": 8, "rocm": 8, "libtilelang": 8, "libtvm": 8, "libtvm_runtim": 8, "bash": 8, "install_cuda": 8, "sh": 8, "install_amd": 8, "featur": 8, "offici": 8, "cu121": 8, "find": 8, "link": 8, "most": 8, "recent": 8, "chang": 8, "less": 8, "stabl": 8, "thei": [8, 9, 13], "re": 8, "ideal": [8, 9], "bugfix": 8, "hasn": 8, "been": [8, 16], "depict": 9, "progress": [9, 17], "descript": 9, "resid": 9, "whichev": 9, "best": [9, 16], "suit": 9, "unawar": 9, "independ": 9, "goal": 9, "basic": 9, "worri": 9, "about": 9, "hierarchi": 9, "fulli": 9, "librari": [9, 10, 17], "consider": 9, "predefin": 9, "leverag": [9, 17], "readi": 9, "made": 9, "dive": [9, 17], "experienc": 9, "characterist": 9, "offer": 9, "direct": 9, "construct": 9, "critic": 9, "grant": 9, "maximum": 9, "special": [9, 13, 17], "tailor": 9, "multi": 9, "core": 9, "expertis": 9, "expand": [9, 17], "encapsul": 9, "synchron": [9, 17], "irmodul": 9, "intermedi": [9, 17], "represent": [9, 17], "ir": [9, 17], "captur": 9, "sourc": [9, 10], "multipl": [9, 10, 13], "matrix": [9, 10], "emploi": [9, 10], "placement": 9, "particular": 9, "bandwidth": [9, 17], "overal": 9, "syntax": [9, 10], "At": 9, "heart": 9, "our": 9, "notion": 9, "class": 9, "object": [9, 16], "repres": [9, 13], "shape": [9, 13], "portion": 9, "own": 9, "manipul": 9, "warp": 9, "equival": 9, "unit": 9, "read": 9, "chunk": 9, "determin": 9, "index": [9, 17], "easier": 9, "hallmark": 9, "place": 9, "rather": 9, "leav": 9, "opaqu": 9, "expos": 9, "face": 9, "physic": 9, "fast": 9, "chip": 9, "storag": [9, 13], "faster": 9, "matric": 9, "sum": 9, "seem": 9, "abund": 9, "wherea": 9, "limit": [9, 17], "becaus": 9, "here": [9, 17], "deriv": 9, "transfer": 9, "furthermor": 9, "fill": [9, 10], "streamlin": 10, "dequant": 10, "flashattent": 10, "linearattent": 10, "underli": [10, 17], "infrastructur": 10, "top": [10, 13, 16], "product": [10, 16], "sacrif": 10, "state": 10, "art": 10, "instal": 10, "pip": 10, "build": 10, "nightli": 10, "brief": 10, "introduct": 10, "interfac": 10, "debug": 10, "elementwis": [10, 16], "gemv": 10, "linear": 10, "convolut": 10, "tmac": 10, "look": 10, "tabl": 10, "precis": 10, "ast": 10, "tilelibrari": 10, "reduce_max": 10, "reduce_sum": 10, "arg": 13, "num_thread": 13, "statement": [13, 17], "There": 13, "sequenti": 13, "prim": 13, "should": 13, "dynam": 13, "whole": 13, "distribut": 13, "store": 13, "partit": 13, "src": [13, 17], "dst": 13, "bufferload": 13, "bufferregion": 13, "start": 13, "point": 13, "param": 13, "know": 13, "region": 13, "zero": 13, "pad": 13, "detect": 13, "boundari": 13, "transpose_a": 13, "transpose_b": 13, "polici": 13, "either": 13, "constraint": 13, "length": 13, "reduct": [13, 16], "axi": 13, "multiplicand": 13, "dim": 13, "arbitrari": 13, "stop": 13, "convert": 13, "async": 13, "reorder": 13, "consum": 13, "doubl": 13, "noth": 13, "l2": 13, "serpentin": 13, "add": 13, "stai": 14, "collect": 14, "app": 14, "yyttt6": 16, "search": 16, "identifi": 16, "readabl": 16, "example_gemm": 16, "py": [16, 17], "complet": [16, 17], "thread_num": 16, "enable_raster": 16, "combinatori": 16, "fals": 16, "given": 16, "itertool": 16, "64": 16, "_config": 16, "list": 16, "autotun": 16, "from_kernel": 16, "get_config": 16, "with_rol": 16, "set_compile_arg": 16, "supply_typ": 16, "tl": 16, "tensorsupplytyp": 16, "integ": 16, "ref_prog": 16, "ref_program": 16, "skip_check": 16, "warmup": 16, "rep": 16, "out_c": 16, "lightweight": 16, "rank": 16, "known": 16, "strategi": [16, 17], "scheme": 16, "transform": [16, 17], "orient": 16, "matmultempl": 16, "arch": 16, "carve_templ": 16, "with_arch": 16, "topk": 16, "roller_hint": 16, "recommend_hint": 16, "rstep": 16, "pipeline_stag": 16, "block_row": 16, "block_col": 16, "rasterization_plan": 16, "noraster": 16, "hereaft": 17, "undergo": 17, "engin": 17, "nvcc": 17, "roughli": 17, "categori": 17, "fail": 17, "error": 17, "incorrect": 17, "expect": 17, "theoret": 17, "focus": 17, "problem": 17, "tool": 17, "nsight": 17, "rocprof": 17, "analysi": 17, "address": 17, "futur": 17, "materi": 17, "lowertileop": 17, "again": 17, "eventu": 17, "translat": 17, "occur": 17, "jump": 17, "instead": 17, "simpl": 17, "1d": 17, "caus": 17, "commun": 17, "35": 17, "q": 17, "shape_q": 17, "yield": 17, "root": 17, "codegen_cuda": 17, "cc": 17, "1257": 17, "valueerror": 17, "lane": 17, "v": 17, "ramp": 17, "somewher": 17, "unsupport": 17, "right": 17, "device_mod": 17, "tir": 17, "filter": 17, "is_device_cal": 17, "mod": 17, "modifi": 17, "codegen": 17, "rt_mod_cuda": 17, "std": 17, "string": 17, "cg": 17, "finish": 17, "registri": 17, "tilelang_callback_cuda_postproc": 17, "henc": 17, "name": 17, "intercept": 17, "register_cuda_postproc_callback": 17, "_": 17, "kernel_sourc": 17, "cuda_runtim": 17, "h": 17, "Be": 17, "mind": 17, "concurr": 17, "debug_print_buff": 17, "debug_print_buffer_condit": 17, "scalar": 17, "debug_print_value_condit": 17, "content": 17, "debug_print_register_fil": 17, "ad": 17, "messag": 17, "prefix": 17, "debug_print_msg": 17, "someth": 17, "msg": 17, "hello": 17, "world": 17, "quickli": 17, "diagnos": 17, "calcul": 17, "deviat": 17, "prong": 17, "suffici": 17, "resolv": 17, "occup": 17, "aspect": 17}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"convolut": 0, "elementwis": 1, "oper": [1, 10], "add": 1, "tilelang": 1, "how": 1, "compil": [1, 9, 16, 18], "dynam": 1, "shape": 1, "address": 1, "boundari": 1, "relat": 1, "issu": [1, 17], "comparison": [1, 5], "cuda": 1, "cute": 1, "conclus": [1, 5, 17], "flash": [2, 3], "attent": [2, 3], "linear": 3, "gener": [4, 5, 6, 16, 17], "matrix": [4, 5, 6, 16, 17], "vector": 4, "multipl": [4, 5, 6, 16, 17], "gemv": 4, "tile": [5, 9, 10, 11, 12, 13, 17, 21], "librari": [5, 21], "why": 5, "anoth": 5, "gpu": 5, "dsl": 5, "exampl": [5, 16, 17], "basic": 5, "structur": 5, "kei": 5, "concept": 5, "other": 5, "perform": [5, 16, 20, 21], "differ": 5, "platform": 5, "further": 5, "resourc": 5, "dequant": 6, "tmac": 7, "look": 7, "up": 7, "tabl": 7, "base": [7, 9], "mix": 7, "precis": 7, "comput": [7, 19], "instal": 8, "guid": 8, "pip": 8, "build": 8, "from": 8, "sourc": [8, 17], "method": 8, "1": [8, 16], "us": [8, 16], "your": 8, "own": 8, "tvm": 8, "2": [8, 16], "bundl": 8, "submodul": 8, "3": [8, 16], "provid": 8, "script": 8, "nightli": 8, "version": 8, "The": 9, "languag": [9, 10, 11, 12, 13, 17], "A": 9, "brief": 9, "introduct": 9, "program": [9, 17], "interfac": 9, "flow": 9, "model": 9, "declar": 9, "explicit": 9, "hardwar": 9, "memori": [9, 15], "alloc": 9, "welcom": 10, "get": 10, "start": 10, "tutori": 10, "deep": 10, "learn": 10, "refer": 10, "privaci": [10, 14], "ast": 11, "primit": [12, 20], "tilelibrari": 13, "t": [13, 17], "kernel": [13, 20, 21], "alloc_shar": 13, "alloc_frag": 13, "copi": 13, "gemm": 13, "reduce_max": 13, "reduce_sum": 13, "parallel": 13, "pipelin": [13, 19], "clear": 13, "fill": 13, "use_swizzl": 13, "annot": 15, "layout": 15, "auto": 16, "tune": 16, "techniqu": 16, "optim": 16, "overview": [16, 17], "step": 16, "implement": 16, "reserv": 16, "paramet": 16, "candid": 16, "configur": 16, "benchmark": 16, "carver": 16, "debug": 17, "correct": 17, "post": 17, "process": 17, "callback": 17, "runtim": 17, "print": 17, "just": 18, "In": 18, "time": 18, "data": 19, "movement": 19, "write": [20, 21], "high": [20, 21], "thread": 20}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Convolution": [[0, "convolution"]], "ElementWise Operators": [[1, "elementwise-operators"]], "Elementwise add in TileLang": [[1, "elementwise-add-in-tilelang"]], "How to compile operators with dynamic shapes?": [[1, "how-to-compile-operators-with-dynamic-shapes"]], "How TileLang addresses boundary-related issues.": [[1, "how-tilelang-addresses-boundary-related-issues"]], "Comparison of TileLang, CUDA, and CuTe": [[1, "comparison-of-tilelang-cuda-and-cute"]], "Conclusion": [[1, "conclusion"], [5, "conclusion"], [17, "conclusion"]], "Flash Attention": [[2, "flash-attention"]], "Flash Linear Attention": [[3, "flash-linear-attention"]], "General Matrix-Vector Multiplication (GEMV)": [[4, "general-matrix-vector-multiplication-gemv"]], "General Matrix-Matrix Multiplication with Tile Library": [[5, "general-matrix-matrix-multiplication-with-tile-library"]], "Why Another GPU DSL?": [[5, "why-another-gpu-dsl"]], "Matrix Multiplication Example": [[5, "matrix-multiplication-example"], [16, "matrix-multiplication-example"], [17, "matrix-multiplication-example"]], "Basic Structure": [[5, "basic-structure"]], "Key Concepts": [[5, "key-concepts"]], "Comparison with Other DSLs": [[5, "comparison-with-other-dsls"]], "Performance on Different Platforms": [[5, "performance-on-different-platforms"]], "Further Resources": [[5, "further-resources"]], "General Matrix-Matrix Multiplication with Dequantization": [[6, "general-matrix-matrix-multiplication-with-dequantization"]], "TMAC: Look Up Table Based Mixed Precision Computing": [[7, "tmac-look-up-table-based-mixed-precision-computing"]], "Installation Guide": [[8, "installation-guide"]], "Installing with pip": [[8, "installing-with-pip"]], "Building from Source": [[8, "building-from-source"]], "Method 1: Install from Source (Using Your Own TVM Installation)": [[8, "method-1-install-from-source-using-your-own-tvm-installation"]], "Method 2: Install from Source (Using the Bundled TVM Submodule)": [[8, "method-2-install-from-source-using-the-bundled-tvm-submodule"]], "Method 3: Install Using the Provided Script": [[8, "method-3-install-using-the-provided-script"]], "Install with Nightly Version": [[8, "install-with-nightly-version"]], "The Tile Language: A Brief Introduction": [[9, "the-tile-language-a-brief-introduction"]], "Programming Interface": [[9, "programming-interface"]], "Programming Interfaces": [[9, "programming-interfaces"]], "Compilation Flow": [[9, "compilation-flow"]], "Tile-based Programming Model": [[9, "tile-based-programming-model"]], "Tile declarations": [[9, "tile-declarations"]], "Explicit Hardware Memory Allocation": [[9, "explicit-hardware-memory-allocation"]], "\ud83d\udc4b Welcome to Tile Language": [[10, "welcome-to-tile-language"]], "GET STARTED": [[10, null]], "TUTORIALS": [[10, null]], "DEEP LEARNING OPERATORS": [[10, null]], "LANGUAGE REFERENCE": [[10, null]], "Privacy": [[10, null], [14, "privacy"]], "Tile Language AST": [[11, "tile-language-ast"]], "Tile Language: Primitives": [[12, "tile-language-primitives"]], "Tile Language: TileLibrary": [[13, "tile-language-tilelibrary"]], "T.Kernel": [[13, "t-kernel"]], "T.alloc_shared": [[13, "t-alloc-shared"]], "T.alloc_fragment": [[13, "t-alloc-fragment"]], "T.copy": [[13, "t-copy"]], "T.gemm": [[13, "t-gemm"]], "T.reduce_max T.reduce_sum": [[13, "t-reduce-max-t-reduce-sum"]], "T.Parallel": [[13, "t-parallel"]], "T.Pipelined": [[13, "t-pipelined"]], "T.clear T.fill": [[13, "t-clear-t-fill"]], "T.use_swizzle": [[13, "t-use-swizzle"]], "Annotate Memory Layout": [[15, "annotate-memory-layout"]], "Auto-Tuning Techniques for Performance Optimization": [[16, "auto-tuning-techniques-for-performance-optimization"]], "Overview": [[16, "overview"], [17, "overview"]], "Step 1: Implement with Reserved Parameters": [[16, "step-1-implement-with-reserved-parameters"]], "Step 2: Generate Candidate Configurations": [[16, "step-2-generate-candidate-configurations"]], "Step 3: Compile and Benchmark": [[16, "step-3-compile-and-benchmark"]], "Using Carver to Auto-Generate Candidate Configurations": [[16, "using-carver-to-auto-generate-candidate-configurations"]], "Debugging Tile Language Programs": [[17, "debugging-tile-language-programs"]], "Debugging Generation Issues": [[17, "debugging-generation-issues"]], "Debugging Correctness Issues": [[17, "debugging-correctness-issues"]], "Post-Processing Callbacks for Generated Source": [[17, "post-processing-callbacks-for-generated-source"]], "Runtime Debug Prints with T.print": [[17, "runtime-debug-prints-with-t-print"]], "Just In Time Compilation": [[18, "just-in-time-compilation"]], "Pipelining Computation and Data Movement": [[19, "pipelining-computation-and-data-movement"]], "Writing High-Performance Kernels with Thread Primitives": [[20, "writing-high-performance-kernels-with-thread-primitives"]], "Writing High-Performance Kernels with the Tile Library": [[21, "writing-high-performance-kernels-with-the-tile-library"]]}, "indexentries": {}})